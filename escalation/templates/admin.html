<!--# Copyright [2020] [Two Six Labs, LLC]-->
<!--# Licensed under the Apache License, Version 2.0-->

{% extends 'base.html' %}

{% block header %}
<script>
    function any_identifiers_active(data_source) {
            const rbs = document.querySelectorAll(`input[form=form_${data_source}]`);
            let flag=0;
            for (const rb of rbs) {
                if (rb.checked && 'active'===rb.value) {
                    flag=1
                }
            }
            if (flag){
                post_to_server(data_source)
            }
            else{
               alert('At least one identifier needs to be active');
            }

        };
    </script>
{% endblock %}


{% block content %}
{% include 'navbar.html' %}
<div class="jumbotron">
    <h1 class="display-4">Administration Options</h1>
    <hr class="my-4">
    <p class="lead">Change what files are shown,...</p>
</div>

<div class="container-fluid pl-5 pr-5">
    {% for data_source, identifiers in data_source_dict.items() %}
        <form method="post" id={{
    "form_" ~ data_source }}>
    <input type="hidden" name="data_sources" value={{ data_source }}>
    </form>
    <div class="row" id={{ data_source }}>
        <h1>{{ data_source }} </h1>
    </div>
    <div class="row">
    <div class="col-10">
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">Identifier</th>
              <th scope="col" class="text-right">Data Set Active</th>
            </tr>
          </thead>
      <tbody>
      {% for identifier in identifiers %}
        <tr>
          <th scope="row">{{ identifier }}</th>
          <td class="text-right">
              {%  set identifier_active = identifier in data_source_active_dict[data_source] %}
              <div class="form-check form-check-inline">
                <label class="form-check-label" for={{ data_source~"_"~identifier~"_active" }}><i class="fa fa-check" aria-hidden="true"></i></label>
                <input class="form-check-input" type="radio" name={{ identifier }} id={{ data_source~"_"~identifier~"_active" }} value='active' form={{ "form_" ~ data_source }} {% if identifier_active %} checked>{% else %} > {% endif %}

            </div>
            <div class="form-check form-check-inline">

                <label class="form-check-label" for={{ data_source~"_"~identifier~"_inactive" }}><i class="fa fa-times" aria-hidden="true"></i></label>
                <input class="form-check-input" type="radio" name={{ identifier }} id={{ data_source~"_"~identifier~"_inactive" }} value='inactive' form={{ "form_" ~ data_source }} {% if identifier_active %} >{% else %} checked> {% endif %}
            </div>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
    </div>
    <div class="col-2 align-self-center">
        <button type="button" class="btn btn-primary btn-lg" onclick=any_identifiers_active('{{ data_source }}')>Update
            </button>
    </div>
    </div>

{% endfor %}
</div>

{% endblock %}


